---
title: "Project_DataExploration"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE) 
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


# Set Working Directory and Load Data 
```{r setup, include=FALSE}
# Set your working directory

setwd("/Users/rmlandman/Desktop/Data Analytics/Environmental_Data_Analytics_2020/Project/EDA_2020_Project")
getwd()

# Load your packages


library(plyr)
library(tidyverse)
library(ggplot2)

# Set your ggplot theme

mytheme <- theme_bw(base_size = 14) +
  theme(axis.text = element_text(color = "black"), 
        legend.position = "top")

theme_set(mytheme)

# Load your datasets

EC_Nutrients_Wide_Processed <- read.csv("./Data/Processed/Ellerbe_Nutrients_Wide_Processed.csv")

EC_Nutrients_USGS_Processed <- read.csv("./Data/Processed/Ellerbe_Nutrients_USGS_Spread.csv")

USGS_Discharge <- read.csv("./Data/Processed/Ellerbe_CombinedDischarge.csv")

EllerbeDischarge_Club <- read.csv("./Data/Processed/EllerbeDischarge_Club.csv")

EllerbeDischarge_Gorman <- read.csv("./Data/Processed/EllerbeDischarge_Gorman.csv")

head(EC_Nutrients_Wide_Processed)
colnames(EC_Nutrients_Wide_Processed)
summary(EC_Nutrients_Wide_Processed$HydrologicEvent)

```



# Format Dates
```{r}
EC_Nutrients_Wide_Processed$ActivityStartDate <- as.Date(EC_Nutrients_Wide_Processed$ActivityStartDate, format = "%Y-%m-%d")
class(EC_Nutrients_Wide_Processed$ActivityStartDate)

EC_Nutrients_USGS_Processed$ActivityStartDate <- as.Date(EC_Nutrients_USGS_Processed$ActivityStartDate, format = "%Y-%m-%d")
class(EC_Nutrients_USGS_Processed$ActivityStartDate)

names(EC_Nutrients_USGS_Processed)[2] <- "Date"

USGS_Discharge$Date <- as.Date(USGS_Discharge$Date, format = "%Y-%m-%d")
class(USGS_Discharge$Date)
```

# Join Discharge and Nutrients 
```{r}
EC_Nutrients_USGS_Processed2 <- separate(EC_Nutrients_USGS_Processed, MonitoringLocationIdentifier, c("agency", "site_no"), sep = "-")

EC_USGS_Combined <- full_join(EC_Nutrients_USGS_Processed2, USGS_Discharge, by = "Date")

EC_Nutrients_USGS_Processed2$site_no <- as.character(EC_Nutrients_USGS_Processed2$site_no)
EllerbeDischarge_Club$site_no <- as.character(EllerbeDischarge_Club$site_no)

EC_Nutrients_Club <- full_join(EC_Nutrients_USGS_Processed2, EllerbeDischarge_Club, by = "site_no")


### need one column for site and one column for date 

EC_Discharge_bind <- rbind(EllerbeDischarge_Club, EllerbeDischarge_Gorman)
EC_Discharge_bind$Date <- as.Date(EC_Discharge_bind$Date, format = "%Y-%m-%d")

EC_Nutrients_Join <- full_join(EC_Discharge_bind, EC_Nutrients_USGS_Processed2, by = c("site_no", "Date"))

```


# Find Start and End dates 
# find out the start and end dates of the dataset
interval(NTL.phys.data.PeterPaul1$sampledate[1], NTL.phys.data.PeterPaul1$sampledate[21613])
interval(first(NTL.phys.data.PeterPaul1$sampledate), last(NTL.phys.data.PeterPaul1$sampledate))


# Get summaries 
NTL.PeterPaul.summaries <- 
  NTL.phys.nutrient.data.PeterPaul %>%
  filter(depth == 0) %>%
  group_by(lakename, month) %>%
  filter(!is.na(temperature_C) & !is.na(tn_ug) & !is.na(tp_ug)) %>%
  summarise(meantemp = mean(temperature_C), 
            sdtemp = sd(temperature_C), 
            meanTN = mean(tn_ug), 
            sdTN = sd(tn_ug), 
            meanTP = mean(tp_ug), 
            sdTP = sd(tp_ug))
# Explore with ggplot 
```{r}
GageHeightplot <-
  ggplot(EC_Nutrients_Wide_Processed, aes(y = Gage.height)) +
  geom_boxplot()
print(GageHeightplot)

GageHeight_Time <-
  ggplot(EC_Nutrients_Wide_Processed, 
         aes(x = ActivityStartDate, y = Gage.height, color = HydrologicEvent))+
  geom_point() 
print(GageHeight_Time)

GageHeight_TP <-
  ggplot(EC_Nutrients_Wide_Processed, 
         aes(x = Gage.height, y = Phosphorus, color = HydrologicEvent))+
  geom_point() 
print(GageHeight_TP)

GageHeight_TN <-
  ggplot(EC_Nutrients_Wide_Processed, 
         aes(x = Gage.height, y = Nitrogen..mixed.forms..NH3....NH4...organic...NO2..and..NO3., color = HydrologicEvent))+
  geom_point() 
print(GageHeight_TN)

GageHeight_TDS <-
  ggplot(EC_Nutrients_Wide_Processed, 
         aes(x = Gage.height, y = Total.dissolved.solids, color = HydrologicEvent))+
  geom_point() 
print(GageHeight_TDS)

```

