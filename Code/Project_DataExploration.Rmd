---
title: "Project_DataExploration"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE) 
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


# Set Working Directory and Load Data 
```{r setup, include=FALSE}
# Set your working directory

setwd("/Users/rmlandman/Desktop/Data Analytics/Environmental_Data_Analytics_2020/Project/EDA_2020_Project")
getwd()

# Load your packages


library(plyr)
library(tidyverse)
library(ggplot2)

# Set your ggplot theme

mytheme <- theme_bw(base_size = 14) +
  theme(axis.text = element_text(color = "black"), 
        legend.position = "top")

theme_set(mytheme)

# Load your datasets

EC_Flow.Nutrients_Wide <-
  read.csv("./Data/Processed/EC_Flow.Nutrients_Wide_Processed.csv")

Club.Gorman_Flow.Nutrients_Wide <-
  read.csv("./Data/Processed/ClubGorman_Flow.Nutrients_Wide_Processed.csv")

Club.Gorman_Flow_Long <- read.csv("./Data/Processed/ClubGorman_USGSDischarge_Long.csv")

Club.Gorman_Flow_Wide <- read.csv("./Data/Processed/ClubGorman_USGSDischarge_Wide.csv")


```

# Format Dates
```{r}
Club.Gorman_Flow.Nutrients_Wide$Date <- 
  as.Date(Club.Gorman_Flow.Nutrients_Wide$Date, format = "%Y-%m-%d")
class(Club.Gorman_Flow.Nutrients_Wide$Date)

Club.Gorman_Flow_Wide$Date <- 
  as.Date(Club.Gorman_Flow_Wide$Date, format = "%Y-%m-%d")
class(Club.Gorman_Flow_Wide$Date)

Club.Gorman_Flow_Long$Date <- 
  as.Date(Club.Gorman_Flow_Long$Date, format = "%Y-%m-%d")
class(Club.Gorman_Flow_Long$Date)

EC_Flow.Nutrients_Wide$Date <- 
  as.Date(EC_Flow.Nutrients_Wide$Date, format = "%Y-%m-%d")
class(EC_Flow.Nutrients_Wide$Date)

```

#Format Site Number to Character
```{r}

Club.Gorman_Flow.Nutrients_Wide$site_no <- 
  as.character(Club.Gorman_Flow.Nutrients_Wide$site_no)
class(Club.Gorman_Flow.Nutrients_Wide$site_no)

Club.Gorman_Flow_Wide$site_no.x <- 
  as.character(Club.Gorman_Flow_Wide$site_no.x)
class(Club.Gorman_Flow_Wide$site_no.x)

Club.Gorman_Flow_Wide$site_no.y <- 
  as.character(Club.Gorman_Flow_Wide$site_no.y)
class(Club.Gorman_Flow_Wide$site_no.y)

Club.Gorman_Flow_Long$site_no <- 
  as.character(Club.Gorman_Flow_Long$site_no, format)
class(Club.Gorman_Flow_Long$site_no)

EC_Flow.Nutrients_Wide$site_no <- 
  as.character(EC_Flow.Nutrients_Wide$site_no)
class(EC_Flow.Nutrients_Wide$site_no)

EC_Flow.Nutrients_Wide$site_no.x <- 
  as.character(EC_Flow.Nutrients_Wide$site_no.x)
class(EC_Flow.Nutrients_Wide$site_no.x)

EC_Flow.Nutrients_Wide$site_no.y <- 
  as.character(EC_Flow.Nutrients_Wide$site_no.y)
class(EC_Flow.Nutrients_Wide$site_no.y)

```


# Find Start and End dates 
# find out the start and end dates of the dataset
```{r}
#Date range for flow 
interval(first(Club.Gorman_Flow_Long$Date), last(Club.Gorman_Flow_Long$Date))

```

interval(first(Club.Gorman_Flow_Long$Date), last(Club.Gorman_Flow_Long$Date))

interval(NTL.phys.data.PeterPaul1$sampledate[1], NTL.phys.data.PeterPaul1$sampledate[21613])
interval(first(NTL.phys.data.PeterPaul1$sampledate), last(NTL.phys.data.PeterPaul1$sampledate))


# Get summaries 
NTL.PeterPaul.summaries <- 
  NTL.phys.nutrient.data.PeterPaul %>%
  filter(depth == 0) %>%
  group_by(lakename, month) %>%
  filter(!is.na(temperature_C) & !is.na(tn_ug) & !is.na(tp_ug)) %>%
  summarise(meantemp = mean(temperature_C), 
            sdtemp = sd(temperature_C), 
            meanTN = mean(tn_ug), 
            sdTN = sd(tn_ug), 
            meanTP = mean(tp_ug), 
            sdTP = sd(tp_ug))
# Flow 
```{r}
GageHeightplot <-
  ggplot(Club.Gorman_Flow_Long, aes(y = X_00060_00003)) +
  geom_boxplot()
print(GageHeightplot)

mean(Club.Gorman_Flow_Long$X_00060_00003)
min(Club.Gorman_Flow_Long$X_00060_00003)
max(Club.Gorman_Flow_Long$X_00060_00003)
sd(Club.Gorman_Flow_Long$X_00060_00003)
IQR(Club.Gorman_Flow_Long$X_00060_00003)


DischargeTimeplot <-
  ggplot(Club.Gorman_Flow_Long, 
         aes(x = Date, y = X_00060_00003, color = site_no))+
  geom_point() 
print(DischargeTimeplot)

```



# Explore Nutrients with ggplot 
```{r}

Discharge_TP <-
  ggplot(EC_Flow.Nutrients_Wide, 
         aes(x = TP, y = X_00060_00003.y, color = HydrologicEvent))+
  xlim(0,400)+
  ylim(0,400)+
  geom_point() 
print(Discharge_TP)

ClubGorman_Discharge_TP <-
  ggplot(Club.Gorman_Flow.Nutrients_Wide, 
         aes(x = TP, y = X_00060_00003, color = HydrologicEvent))+
   xlim(0,400)+
  geom_point() 
print(ClubGorman_Discharge_TP)

Discharge_TN <-
  ggplot(EC_Flow.Nutrients_Wide, 
         aes(x = Inorganic_N, y = X_00060_00003.x, color = HydrologicEvent))+
  geom_point() 
print(Discharge_TN)

Discharge_Turbidity <-
  ggplot(EC_Flow.Nutrients_Wide, 
         aes(x = Turbidity, y = X_00060_00003.x, color = HydrologicEvent))+
  geom_point() 
print(Discharge_Turbidity)

Discharge_XY <-
  ggplot(EC_Flow.Nutrients_Wide, 
         aes(x = X_00060_00003.x, y = X_00060_00003.y, color = HydrologicEvent))+
  geom_point() 
print(Discharge_XY)

TP_TN <- 
   ggplot(EC_Flow.Nutrients_Wide, 
         aes(x = Mixed_N, y = TP, color = site_no))+
  geom_point()+
print(TP_TN)

```

